Процедура авторизации
---------------------

1. Редирект (мак, профиль)

2. Подтверждение старой привязки мака. Пользователь указывает последние цифры в номере телефона или "не я" и идет в черендж

3. Получение списка челенжей (смс,звонок,токен..), выбор приоритетного сразу, если есть альтернативы - ссылка другие способы авторизации.

4. Ввод номера телефона или логина. Получение кода смс или совершение звонка

5. Запрос на привязку. Создается учетка логин+мак

6. Получение временного пароля

7. Отправка в роутер запроса на авторизацию

8. Редирект в интернет или на 204


Редирект
--------

{PROTO}://{IP}:{PORT}/uam/register/?nasid=$(identity)&called=$(server-name)&mac=$(mac-esc)&linklogin=$(link-login-only-esc)&linkorig=$(link-orig-esc)

identity - хостнейм роутера
called - имя хотспота, соответствует профилю настроек
mac - мак терминала пользователя
linklogin - куда отправляем форму авторизации
linkorig - запрошенный пользователем адрес

результатом возвращается редирект на приложение авторизации с сессионной кукой


Подтверждение привязки
----------------------

UAM делает запрос на апи, получает маску (номера телефона) и имя атрибута формы.
Если есть кука "запомнить меня" - номер извлекается из неё и считается подтвержденным.
Делает второй запрос с передачей номера.
Если не угадал номер или по ссылке "не я" - на челендж 

POST /api/uam/check/
ident=(логин, емаил или номер телефона полностью)
save=(yes,no)


Список челенджей, форма, запрос на привязку
-------------------------------------------

sms_in - in - относительно абонента
sms_out
call_in
call_out
admin_totp - через авторизатор у администратора
qrcode - через читалку куркодов. ссылка на админку с кнопкой подтвердить вручную. 
oauth - госуслуги
pay - номер платежки

группы: предпочитаемый, дополнительные, запасные

предпочитаемый открывается сразу
дополнительные по ссылке снизу
запасные открываются вместе с дополнительными если возникли проблемы с предпочитаемым или дополнительным методом. при этом метод помечается 
как недоступный.

список запрашивается при каждом переходе на этом пункте



Получение пароля
----------------

При отправки челенджа или при подтверждении старой привязки вместе с полем sucess получаем логин и пароль для авторизации на роутере. ссылку 
авторизации, тип хотспота.

Далее по ссылке для входа и типу формируется запрос на статус, в котором нужно получить челендж для чапа. Дальше формирутся ссылка логина и 
отправляется запрос туда.

все методы апи оформляются в отдельный js.

чекаем ещё раз статус и открываем редирект в новом окне по кнопке "в интернет" или  
